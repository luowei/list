<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>知不知</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="theme-color" content="#157878"> <link rel="stylesheet" href="/list/assets/css/normalize.css"> <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'> <link rel="stylesheet" href="/list/assets/css/cayman.css"> </head> <body> <section class="page-header"> <h1 class="project-name">知不知</h1> <h2 class="project-tagline"><a style="color:#ffffff;" href="http://luowei.github.io/list">知不知</a> 是一个代码爱好者的技术知识分享部落格。</h2> <a href="http://wodedata.com" target="_blank" class="btn">wodedata</a> <a href="/list" class="btn">home</a> <a href="http://app.wodedata.com" target="_blank" class="btn">APP作品</a> </section> <section class="main-content"> <!-- 标题 --> <h2>数据结构-位操作技巧归纳</h2> <!-- Google Ads --> <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-8760692904992206" data-ad-slot="2948937366"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <p><strong>检测一个无符号数是不为</strong><code class="highlighter-rouge">2^n-1(^为幂)： x&amp;(x+1)</code></p> <p><strong>将最右侧0位改为1位：</strong> <code class="highlighter-rouge">x | (x+1)</code></p> <p><strong>二进制补码运算公式：</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">~</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span>
<span class="o">-</span><span class="p">(</span><span class="o">~</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span>
<span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="o">~</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">|</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="o">~</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">|~</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="o">~</span><span class="n">x</span><span class="o">&amp;</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">|</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span><span class="o">|</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">&amp;~</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">y</span>
<span class="n">x</span><span class="o">&amp;</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span><span class="o">|</span><span class="n">y</span><span class="p">)</span><span class="o">-~</span><span class="n">x</span>
<span class="n">x</span><span class="o">==</span><span class="n">y</span><span class="o">:</span>    <span class="o">~</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">|</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span><span class="o">!=</span><span class="n">y</span><span class="o">:</span>    <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">|</span><span class="n">y</span><span class="o">-</span><span class="n">x</span>
<span class="n">x</span><span class="o">&lt;</span> <span class="n">y</span><span class="o">:</span>    <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="n">x</span><span class="p">))</span>
<span class="n">x</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">:</span>    <span class="p">(</span><span class="n">x</span><span class="o">|~</span><span class="n">y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="o">|~</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="n">x</span><span class="o">&lt;</span> <span class="n">y</span><span class="o">:</span>    <span class="p">(</span><span class="o">~</span><span class="n">x</span><span class="o">&amp;</span><span class="n">y</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="o">~</span><span class="n">x</span><span class="o">|</span><span class="n">y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">))</span><span class="c1">//无符号x,y比较</span>
<span class="n">x</span><span class="o">&lt;=</span><span class="n">y</span><span class="o">:</span>    <span class="p">(</span><span class="o">~</span><span class="n">x</span><span class="o">|</span><span class="n">y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="o">|~</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="c1">//无符号x,y比较</span>
</code></pre></div></div> <p><strong>使用位运算的无分支代码：</strong><br /> 计算绝对值</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">abs</span><span class="p">(</span> <span class="kt">int</span> <span class="n">x</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">y</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span> <span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">y</span> <span class="p">;</span><span class="c1">//or: (x+y)^y</span>
<span class="p">}</span>
</code></pre></div></div> <p>符号函数：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sign</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="kt">int</span> <span class="nf">sign</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">31</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="o">&gt;&gt;</span><span class="mi">31</span> <span class="p">;</span><span class="c1">//x=-2^31时失败(^为幂)</span>
<span class="p">}</span>
</code></pre></div></div> <p>三值比较：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">==</span><span class="n">y</span><span class="p">;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span>
<span class="kt">int</span> <span class="nf">cmp</span><span class="p">(</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>
<span class="n">doz</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">&gt;=</span><span class="n">y</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span>
<span class="kt">int</span> <span class="nf">doz</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">d</span> <span class="p">;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">d</span> <span class="o">&amp;</span> <span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="n">d</span><span class="o">^</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">d</span><span class="o">^</span><span class="n">x</span><span class="p">))))</span><span class="o">&gt;&gt;</span><span class="mi">31</span><span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">max</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="p">;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">31</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="n">m</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">m</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>不使用第三方交换x,y:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="n">x</span> <span class="o">^=</span> <span class="n">y</span> <span class="p">;</span> <span class="n">y</span> <span class="o">^=</span> <span class="n">x</span> <span class="p">;</span> <span class="n">x</span> <span class="o">^=</span> <span class="n">y</span> <span class="p">;</span>
<span class="mi">2</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="p">;</span>
<span class="mi">3</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="n">x</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">x</span> <span class="p">;</span>
<span class="mi">4</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">x</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">-</span><span class="n">x</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="p">;</span>
</code></pre></div></div> <p>双值交换:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="o">==</span><span class="n">b</span><span class="p">;</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="o">==</span><span class="n">a</span><span class="c1">//常规编码为x = x==a ? b :a ;</span>
<span class="mi">1</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="n">x</span> <span class="p">;</span>
<span class="mi">2</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">^</span><span class="n">b</span><span class="o">^</span><span class="n">x</span> <span class="p">;</span>
</code></pre></div></div> <p>下舍入到2的k次方的倍数:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="n">x</span> <span class="o">&amp;</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.(((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">x</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="n">k</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">k</span>
</code></pre></div></div> <p>上舍入：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">&amp;~</span><span class="n">t</span> <span class="p">;</span>
<span class="mi">2</span><span class="p">.</span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">k</span> <span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="n">t</span> <span class="p">;</span>
</code></pre></div></div> <p><strong>位计数,统计1位的数量：</strong></p> <ol> <li> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">pop</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x55555555</span><span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="mh">0x33333333</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x33333333</span> <span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x0f0f0f0f</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span> <span class="p">;</span>
<span class="k">return</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x0000003f</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div> </div> </li> <li> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">pop</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
<span class="k">static</span> <span class="kt">char</span> <span class="n">table</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">....,</span> <span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span> <span class="p">}</span> <span class="p">;</span>
<span class="k">return</span> <span class="n">table</span><span class="p">[</span><span class="n">x</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="p">[(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="p">[(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="p">[(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">24</span><span class="p">)]</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div> </div> </li> </ol> <p><strong>奇偶性计算:</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span> <span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span> <span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">2</span> <span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span> <span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">4</span> <span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span> <span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">8</span> <span class="p">)</span> <span class="p">;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="p">(</span> <span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">16</span> <span class="p">)</span> <span class="p">;</span>
</code></pre></div></div> <p>结果中位于x最低位，对无符号x,结果的第i位是原数第i位到最左侧位的奇偶性位反转：</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="nf">rev</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x55555555</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x55555555</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x33333333</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x33333333</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x0f0f0f0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x0f0f0f0f</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">x</span><span class="o">&amp;</span><span class="mh">0xff00</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff00</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">24</span><span class="p">)</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>递增位反转后的数：</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="nf">inc_r</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="n">m</span> <span class="o">=</span> <span class="mh">0x80000000</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">^=</span> <span class="n">m</span> <span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">do</span> <span class="p">{</span> <span class="n">m</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span> <span class="p">;</span> <span class="n">x</span> <span class="o">^=</span> <span class="n">m</span> <span class="p">;</span> <span class="p">}</span> <span class="k">while</span><span class="p">(</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="p">)</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>混选位：</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">abcd</span> <span class="n">efgh</span> <span class="n">ijkl</span> <span class="n">mnop</span> <span class="n">ABCD</span> <span class="n">EFGH</span> <span class="n">IJKL</span> <span class="n">MNOP</span><span class="o">-&gt;</span><span class="n">aAbB</span> <span class="n">cCdD</span> <span class="n">eEfF</span> <span class="n">gGhH</span> <span class="n">iIjJ</span> <span class="n">kKlL</span> <span class="n">mMnN</span> <span class="n">oOpP</span>
<span class="kt">unsigned</span> <span class="nf">ps</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="n">t</span> <span class="p">;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x0000ff00</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="n">t</span> <span class="o">^</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x00f000f0</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="n">t</span> <span class="o">^</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x0c0c0c0c</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="n">t</span> <span class="o">^</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x22222222</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="n">t</span> <span class="o">^</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>位压缩：</strong><br /> 选择并右移字x中对应于掩码m的1位的位,如：<code class="highlighter-rouge">compress(abcdefgh,01010101)=0000bdfh</code><br /> compress_left(x,m)操作与此类似，但结果位在左边: <code class="highlighter-rouge">bdfh0000</code>.</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="nf">compress</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="n">mk</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">t</span> <span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">&amp;=</span> <span class="n">m</span> <span class="p">;</span>
    <span class="n">mk</span> <span class="o">=</span> <span class="o">~</span><span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="p">;</span>
    <span class="k">for</span><span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="n">mk</span> <span class="o">^</span> <span class="p">(</span> <span class="n">mk</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
        <span class="n">mp</span> <span class="o">^=</span> <span class="p">(</span> <span class="n">mp</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">mp</span> <span class="o">^=</span> <span class="p">(</span> <span class="n">mp</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">mp</span> <span class="o">^=</span> <span class="p">(</span> <span class="n">mp</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">mp</span> <span class="o">^=</span> <span class="p">(</span> <span class="n">mp</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">mv</span> <span class="o">=</span> <span class="n">mp</span> <span class="o">&amp;</span> <span class="n">m</span> <span class="p">;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">^</span> <span class="n">mv</span> <span class="o">|</span> <span class="p">(</span><span class="n">mv</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">mv</span> <span class="p">;</span>
        <span class="n">x</span>  <span class="o">=</span> <span class="n">x</span> <span class="o">^</span> <span class="n">t</span> <span class="o">|</span> <span class="p">(</span> <span class="n">t</span> <span class="o">&gt;&gt;</span> <span class="p">(</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">mk</span> <span class="o">=</span> <span class="n">mk</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">mp</span> <span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">x</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>位置换：</strong><br /> 用32个5位数表示从最低位开始的位的目标位置，结果是一个32*5的位矩阵，将该矩阵沿次对角线转置后用5个32位字p[5]存放。</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">compress_left</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="o">|</span> <span class="n">compress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">~</span><span class="n">m</span><span class="p">)</span> <span class="p">;</span>
</code></pre></div></div> <p><strong>准备工作：</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">p</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">SAG</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>实际置换：</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">rep</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="n">x</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">SAG</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
    <span class="k">return</span> <span class="n">x</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>**二进制码到GRAY码的转换: **</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="nf">B2G</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">B</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">B</span> <span class="o">^</span> <span class="p">(</span><span class="n">B</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>GRAY码到二进制码:</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="nf">G2B</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">G</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="n">B</span> <span class="p">;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">G</span> <span class="o">^</span> <span class="p">(</span><span class="n">G</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">G</span> <span class="o">^</span> <span class="p">(</span><span class="n">G</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">G</span> <span class="o">^</span> <span class="p">(</span><span class="n">G</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">G</span> <span class="o">^</span> <span class="p">(</span><span class="n">G</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">G</span> <span class="o">^</span> <span class="p">(</span><span class="n">G</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">B</span> <span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>找出最左0字节的位置:</strong></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">zbytel</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="n">x</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="n">cahr</span> <span class="n">table</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="p">}</span> <span class="p">;</span>
    <span class="kt">unsigned</span> <span class="n">y</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">&amp;</span><span class="mh">0x7f7f7f7f</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x7f7f7f7f</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">y</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="mh">0x7f7f7f7f</span><span class="p">)</span> <span class="p">;</span>
    <span class="k">return</span> <span class="n">table</span><span class="p">[</span><span class="n">y</span><span class="o">*</span><span class="mh">0x00204081</span> <span class="o">&gt;&gt;</span> <span class="mi">28</span><span class="p">]</span> <span class="p">;</span><span class="c1">//乘法可用移位和加完成</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="常用技巧">常用技巧</h3> <p><strong>用于整数的奇偶性判断</strong> <br /> 一个整数a, a &amp; 1 这个表达式可以用来判断a的奇偶性。二进制的末位为0表示偶数，最末位为1表示奇数。使用a%2来判断奇偶性和a &amp; 1是一样的作用，但是a &amp; 1要快好多。</p> <p><strong>判断n是否是2的正整数冪</strong><br /> <code class="highlighter-rouge">(!(n&amp;(n-1)) ) &amp;&amp; n</code><br /> 举个例子： <br /> 如果<code class="highlighter-rouge">n = 16 = 10000， n-1 = 1111</code><br /> 那么：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 10000
&amp; 1111
----------
     0
</code></pre></div></div> <p>再举一个例子：如果<code class="highlighter-rouge">n = 256 = 100000000， n-1 = 11111111</code><br /> 那么：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  100000000
&amp; 11111111
--------------
  0
</code></pre></div></div> <p><strong>统计n中1的个数</strong></p> <blockquote> <p>朴素的统计办法是：先判断n的奇偶性，为奇数时计数器增加1，然后将n右移一位，重复上面步骤，直到移位完毕。</p> <p>朴素的统计办法是比较简单的，那么我们来看看比较高级的办法。</p> <p>举例说明，考虑2位整数 n=11，里边有2个1，先提取里边的偶数位10，奇数位01，把偶数位右移1位，然后与奇数位相加，因为每对奇偶位相加的和不会超过”两位”，所以结果中每两位保存着数n中1的个数；相应的如果n是四位整数 n=0111，先以”一位”为单位做奇偶位提取，然后偶数位移位（右移1位），相加；再以”两位”为单位做奇偶提取，偶数位移位（这时就需要移2位），相加，因为此时没对奇偶位的和不会超过”四位”，所以结果中保存着n中1的个数，依次类推可以得出更多位n的算法。整个思想类似分治法。</p> </blockquote> <p>在这里就顺便说一下常用的二进制数：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0xAAAAAAAA=10101010101010101010101010101010
0x55555555 = 1010101010101010101010101010101（奇数位为1，以1位为单位提取奇偶位）
0xCCCCCCCC = 11001100110011001100110011001100
0x33333333 = 110011001100110011001100110011（以"2位"为单位提取奇偶位）
0xF0F0F0F0 = 11110000111100001111000011110000
0x0F0F0F0F = 1111000011110000111100001111（以"8位"为单位提取奇偶位）
0xFFFF0000 =11111111111111110000000000000000
0x0000FFFF = 1111111111111111（以"16位"为单位提取奇偶位）
</code></pre></div></div> <p>例如：32位无符号数的1的个数可以这样数：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int count_one(unsigned long n)
{
    //0xAAAAAAAA，0x55555555分别是以"1位"为单位提取奇偶位
    n = ((n &amp; 0xAAAAAAAA) &gt;&gt; 1) + (n &amp; 0x55555555);
    //0xCCCCCCCC，0x33333333分别是以"2位"为单位提取奇偶位
    n = ((n &amp; 0xCCCCCCCC) &gt;&gt; 2) + (n &amp; 0x33333333);
    //0xF0F0F0F0，0x0F0F0F0F分别是以"4位"为单位提取奇偶位
    n = ((n &amp; 0xF0F0F0F0) &gt;&gt; 4) + (n &amp; 0x0F0F0F0F);
    //0xFF00FF00，0x00FF00FF分别是以"8位"为单位提取奇偶位
    n = ((n &amp; 0xFF00FF00) &gt;&gt; 8) + (n &amp; 0x00FF00FF);
    //0xFFFF0000，0x0000FFFF分别是以"16位"为单位提取奇偶位
    n = ((n &amp; 0xFFFF0000) &gt;&gt; 16) + (n &amp; 0x0000FFFF);
    return n;
}
</code></pre></div></div> <p>举个例子吧，比如说我的生日是农历2月11，就用211吧，转成二进制：<code class="highlighter-rouge">n = 11010011</code></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>计算n = ((n &amp; 0xAAAAAAAA) &gt;&gt; 1) + (n &amp; 0x55555555);
得到        n = 10010010
计算n = ((n &amp; 0xCCCCCCCC) &gt;&gt; 2) + (n &amp; 0x33333333);
得到        n = 00110010
计算n = ((n &amp; 0xF0F0F0F0) &gt;&gt; 4) + (n &amp; 0x0F0F0F0F);
得到        n = 00000101 -----------------à无法再分了，那么5就是答案了。
</code></pre></div></div> <p><strong>对于正整数的模运算（注意，负数不能这么算）</strong></p> <p>先说下比较简单的：</p> <blockquote> <p>乘除法是很消耗时间的，只要对数左移一位就是乘以2，右移一位就是除以2，传说用位运算效率提高了60%。</p> <p>乘2^k 众所周知： n«k。所以你以后还会傻傻地去敲2566*4的结果10264吗？直接2566«4就搞定了，又快又准确。</p> <p>除2^k众所周知： n»k。</p> </blockquote> <p>那么 mod 2^k 呢？（对2的倍数取模）<br /> <code class="highlighter-rouge">**n&amp;((1&lt;&lt;k)-1)**</code><br /> 用通俗的言语来描述就是,对2的倍数取模，只要将数与2的倍数-1做按位与运算即可。<br /> 好！方便理解就举个例子吧。</p> <p>思考：如果结果是要求模2^k时，我们真的需要每次都取模吗？<br /> 在此很容易让人想到快速幂取模法。</p> <p><strong>快速幂取模算法</strong><br /> 经常做题目的时候会遇到要计算 a^b mod c 的情况，这时候，一个不小心就TLE了。那么如何解决这个问题呢？位运算来帮你吧。<br /> 首先介绍一下秦九韶算法：(数值分析讲得很清楚)<br /> 把一个n次多项式<code class="highlighter-rouge">f(x) = a[n]x^n+a[n-1]x^(n-1)+......+a[1]x+a[0]</code>改写成如下形式：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>　　f(x) = a[n]x^n+a[n-1]x^(n-1))+......+a[1]x+a[0]
　　= (a[n]x^(n-1)+a[n-1]x^(n-2)+......+a[1])x+a[0]
　　= ((a[n]x^(n-2)+a[n-1]x^(n-3)+......+a[2])x+a[1])x+a[0]
　　=. .....
　　= (......((a[n]x+a[n-1])x+a[n-2])x+......+a[1])x+a[0].
　　求多项式的值时，首先计算最内层括号内一次多项式的值，即
　　v[1]=a[n]x+a[n-1]
　　然后由内向外逐层计算一次多项式的值，即
　　v[2]=v[1]x+a[n-2]
　　v[3]=v[2]x+a[n-3]
　　......
　　v[n]=v[n-1]x+a[0]
</code></pre></div></div> <p>这样，求n次多项式f(x)的值就转化为求n个一次多项式的值。</p> <p>好！有了前面的基础知识，我们开始解决问题吧.<br /> 由<code class="highlighter-rouge">(a × b) mod c=( (a mod c) × b) mod c</code>.</p> <p>我们可以将 b先表示成：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b = a[t] × 2^t + a[t-1]× 2^(t-1) + …… + a[0] × 2^0.
(a[i]=[0,1]).
</code></pre></div></div> <p>这样我们由 <code class="highlighter-rouge">a^b mod c = (a^(a[t] × 2^t + a[t-1] × 2^（t-1） + …a[0] × 2^0) mod c</code>.<br /> 然而我们求 <code class="highlighter-rouge">a^( 2^(i+1) ) mod c=( (a^(2^i)) mod c)^2 mod c</code> .求得。</p> <p><strong>具体实现如下：</strong><br /> 使用<strong>秦九韶算法</strong>思想进行快速幂模算法，简洁漂亮</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 快速计算 (a ^ p) % m 的值
__int64 FastM(__int64 a, __int64 p, __int64 m)
{ 
    if (p == 0) return 1;
    __int64  r = a % m;
    __int64  k = 1;
    while (p &gt; 1)
    {
        if ((p &amp; 1)!=0)
        {
            k = (k * r) % m; 
        }
        r = (r * r) % m;
        p &gt;&gt;= 1;
    }
    return (r * k) % m;
}
</code></pre></div></div> <p>参考：<a href="http://acm.pku.edu.cn/JudgeOnline/problem?id=3070">http://acm.pku.edu.cn/JudgeOnline/problem?id=3070</a></p> <p><span class="site-footer-credits">版权所有，转载请注明出处 <a href="https://luowei.github.io/list">luowei.github.io</a>.</span></p> <link rel="stylesheet" href="/list/assets/css/font-awesome.min.css?ver=20151122" /> <!--[if IE 7 ]><link rel="stylesheet" href="/list/assets/css/font-awesome-ie7.min.css?ver=20151122"><![endif]--> <div style="float: right"> <span id="share"> <a class="wechat" target="_blank" title="分享到微信" href="https://chart.apis.google.com/chart?cht=qr&amp;chs=300x300&amp;chl=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html"><i class="icon-large icon-wechat"></i></a> <a class="weibo" target="_blank" title="分享到微博" href="http://service.weibo.com/share/share.php?title=数据结构-位操作技巧归纳 - 知不知&amp;url=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html&amp;type=3&amp;searchPic=1"><i class="icon-large icon-weibo"></i></a> <a class="qzone" target="_blank" title="分享到 QQ 空间" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html&amp;title=数据结构-位操作技巧归纳 - 知不知&amp;summary=位操作技巧归纳&amp;site=/list"><i class="icon-large icon-qzone"></i></a> <a class="twitter" target="_blank" title="Share to Twitter" href="https://twitter.com/intent/tweet?url=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html&amp;text=数据结构-位操作技巧归纳 - 知不知&amp;via=luowei010101"><i class="icon-large icon-twitter"></i></a> <a class="facebook" target="_blank" title="Share to Facebook" href="https://www.facebook.com/sharer.php?u=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html&amp;t=数据结构-位操作技巧归纳 - 知不知"><i class="icon-large icon-facebook-sign"></i></a> <a class="googleplus" target="_blank" title="Share to Google+" href="https://plus.google.com/share?url=/list/docs/C_CPP/2011-09-12-%E4%BD%8D%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%E5%BD%92%E7%BA%B3.html"><i class="icon-large icon-google-plus-sign"></i></a> </span> </div> <hr /> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" /> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <div id="gitalk-container"></div> <script type="text/javascript"> var gitalk = new Gitalk({ clientID: '9d5ee666269c252cf949', clientSecret: '728cd598f1fca9d8c1df1dfa300057883a3a8676', repo: 'list', owner: 'luowei', admin: ['luowei'], id: decodeURI('数据结构-位操作技巧归纳'), distractionFreeMode: false }); gitalk.render('gitalk-container'); </script> <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1277627361'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s96.cnzz.com/z_stat.php%3Fid%3D1277627361%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script> <footer class="site-footer"> <span class="site-footer-owner"><a href="">知不知</a> is maintained by <a href="http://luowei.github.io/list">luowei</a>.</span> <span class="site-footer-credits">Developed by <a href="https://luowei.github.io">luowei</a>.</span> </footer> </section> </body> </html>
