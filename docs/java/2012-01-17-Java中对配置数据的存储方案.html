<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>知不知</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="theme-color" content="#157878"> <meta name="baidu-site-verification" content="" /> <meta name="apple-itunes-app" content="app-id=1227288468, app-argument=https://luowei.github.io/list/docs/java/2012-01-17-Java%E4%B8%AD%E5%AF%B9%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88.html"> <link rel="stylesheet" href="https://luowei.github.io/list/assets/css/normalize.css"> <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'> <link rel="stylesheet" href="https://luowei.github.io/list/assets/css/cayman.css"> </head> <body> <section class="page-header"> <h1 class="project-name">知不知</h1> <h2 class="project-tagline"><a style="color:#ffffff;" href="http://luowei.github.io/list">知不知</a> 是一个代码爱好者的技术知识分享部落格。</h2> <a href="http://wodedata.com" target="_blank" class="btn">wodedata</a> <a href="https://luowei.github.io/list" class="btn">home</a> <a href="http://app.wodedata.com" target="_blank" class="btn">APP作品</a> </section> <section class="main-content"> <!-- 标题 --> <h2>Java-Java中对配置数据的存储方案</h2> <!-- Google Ads --> <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-8760692904992206" data-ad-slot="2948937366"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></p> <h3 id="以前的方式getresourceasstream">以前的方式(getResourceAsStream)</h3> <p><strong>直接读取资源文件</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreateVvvvid</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">AtomicInteger</span><span class="o">&gt;</span> <span class="n">vvvvidCreateMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">AtomicInteger</span><span class="o">&gt;();</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="c1">// 获取数据库配置文件</span>
        <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">getProperties</span><span class="o">(</span>
                <span class="nc">CreateVvvvid</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"/config/database.properties"</span><span class="o">));</span>
        <span class="kt">int</span> <span class="n">maxVvvvid</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="nc">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="cm">/**
             * 读取数据库连接参数
             */</span>
            <span class="nc">String</span> <span class="n">driverName</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"database.driverClassName"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"database.url"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">root</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"database.username"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"database.password"</span><span class="o">);</span>
            <span class="cm">/**
             * 初始化数据库连接，获取当前vvvvid最大值
             */</span>
            <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">driverName</span><span class="o">);</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">root</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>
            <span class="nc">Statement</span> <span class="n">stat</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
            <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT MAX(vvvvid) AS vvvvid FROM tt_user WHERE vvvvid Like '25%'"</span><span class="o">;</span>
            <span class="nc">ResultSet</span> <span class="n">rst</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">rst</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">maxVvvvid</span> <span class="o">=</span> <span class="n">rst</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"vvvvid"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="kt">int</span> <span class="n">max</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
            <span class="c1">// 如果找不到vvvvid则从0开始增涨</span>
            <span class="k">if</span> <span class="o">(</span><span class="mi">0</span> <span class="o">!=</span> <span class="n">maxVvvvid</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//如果非零则截取字符，初始化自增长类</span>
                <span class="nc">String</span> <span class="n">maxVvvvid1</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">maxVvvvid</span><span class="o">);</span>
                <span class="c1">//等进一步完善????????</span>
                <span class="n">maxVvvvid1</span> <span class="o">=</span> <span class="n">maxVvvvid1</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">maxVvvvid1</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="err">'</span><span class="mi">555</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
                        <span class="n">max</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">maxVvvvid1</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">vvvvidCreateMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">AtomicInteger</span><span class="o">(</span><span class="n">max</span><span class="o">+</span><span class="mi">1</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="c1">//关闭连接</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>对property文件读写工具</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PropertiesUtil</span> <span class="o">{</span>
    <span class="cm">/**
     * 获取Properties对象(默认为utf-8字符编码)
     * @param filePath 件路径 
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Properties</span> <span class="nf">getProperties</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">getProperties</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 获取Properties对象(默认为utf-8字符编码)
     * @author wei.luo
     * @param in 输入流
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Properties</span> <span class="nf">getProperties</span><span class="o">(</span><span class="nc">InputStream</span> <span class="n">in</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">f</span><span class="o">(</span><span class="n">in</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
            <span class="n">eturn</span> <span class="kc">null</span><span class="o">;</span>
            <span class="c1">// 定义properties对象 </span>
            <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
            <span class="c1">// 加载properties文件 </span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">props</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">in</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">));</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">props</span><span class="o">;</span>
        <span class="o">}</span>
<span class="cm">/**
 * 获取Properties对象 
 * @param filePath 件路径 
 * @param encoding 符编码 
 * @return
 */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Properties</span> <span class="nf">getProperties</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">encoding</span><span class="o">)</span> <span class="o">{</span>
<span class="c1">// 定义properties对象 </span>
        <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
<span class="c1">// 判断文件是否存在，如果不存在则创建文件</span>
            <span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">filePath</span><span class="o">);</span>
            <span class="nc">File</span> <span class="n">dirFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getParent</span><span class="o">());</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">dirFile</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">dirFile</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">file</span><span class="o">.</span><span class="na">createNewFile</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="nc">Reader</span> <span class="n">rd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">),</span>
                    <span class="n">encoding</span><span class="o">);</span>
<span class="c1">// 加载properties文件 </span>
            <span class="n">props</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">rd</span><span class="o">);</span>
            <span class="n">rd</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">props</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 获取key对应的value值 默认为utf-8
     * @param filePath
     * @param name
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">readValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span><span class="nc">String</span> <span class="n">name</span><span class="o">){</span>
        <span class="k">return</span> <span class="nf">readValue</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 获取key对应的value值 
     * @param filePath
     * @param encoding
     * @param name
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">readValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span><span class="nc">String</span> <span class="n">encoding</span><span class="o">,</span><span class="nc">String</span> <span class="n">name</span><span class="o">){</span>
        <span class="nc">Properties</span> <span class="n">props</span><span class="o">=</span><span class="n">getProperties</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="n">encoding</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 写资源文件(默认为utf-8编码)
     * @param filePath 文件路径 
     * @param name 名称 
     * @param value 值 
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">write</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 写property文件 
     * @param filePath 文件路径 
     * @param encoding 文件编码 
     * @param name 名称 
     * @param value 值 
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">encoding</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span>
                             <span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="n">getProperties</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">encoding</span><span class="o">);</span>
            <span class="n">props</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="nc">Writer</span> <span class="n">osw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OutputStreamWriter</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">filePath</span><span class="o">),</span>
                    <span class="n">encoding</span><span class="o">);</span>
<span class="c1">// 以适合使用load方法加载到Properties表中的格式，将此Properties表中的属性列表（键和元素对）写入输出流</span>
<span class="c1">// props.store(fos, "Update '" + parameterName + "' value");</span>
            <span class="n">props</span><span class="o">.</span><span class="na">store</span><span class="o">(</span><span class="n">osw</span><span class="o">,</span> <span class="s">""</span><span class="o">);</span>
            <span class="n">osw</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
<span class="c1">// TODO Auto-generated catch block</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 读取properties的全部信息 
     * @param filePath
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HashMap</span> <span class="nf">readAll</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">readAll</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 读取properties的全部信息 
     * @param filePath 文件路径 
     * @param encoding 字符编码 
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">HashMap</span> <span class="nf">readAll</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">encoding</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HashMap</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
        <span class="nc">Properties</span> <span class="n">props</span> <span class="o">=</span> <span class="n">getProperties</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">encoding</span><span class="o">);</span>
<span class="c1">// 获取所有的key，放入枚举类型中 </span>
        <span class="nc">Enumeration</span> <span class="n">en</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="na">propertyNames</span><span class="o">();</span>
<span class="c1">// 遍历枚举，根据key取出value </span>
        <span class="k">while</span> <span class="o">(</span><span class="n">en</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">en</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span>
            <span class="nc">String</span> <span class="n">property</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
<span class="c1">// 将值放入key中 </span>
            <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">property</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">map</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">filePath</span> <span class="o">=</span> <span class="s">"D://aaaa.properties"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"testaaaa"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">parameterValue</span> <span class="o">=</span> <span class="s">"测试！！！"</span><span class="o">;</span>
        <span class="nc">Object</span> <span class="o">[]</span><span class="n">obs</span><span class="o">={</span><span class="s">"ee"</span><span class="o">,</span><span class="s">"ff"</span><span class="o">};</span>
<span class="c1">// write(filePath, name, parameterValue);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">MessageFormat</span><span class="o">.</span><span class="na">format</span> <span class="o">(</span><span class="n">readValue</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span><span class="n">name</span><span class="o">),</span> <span class="n">obs</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="应用单例的方式">应用单例的方式</h3> <p><strong>属性文件(pathConfig.properties)</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lis.interface = http://aaaaa.vvvv.com/lis
listenok = true
listlistenok = true
property.path = WEB-INF/classes/config/properties/pathConfig.properties
parent.path = E:/workspaces3/vvvv/WebRoot/files
bak.parent.path = E:/workspaces3/vvvv/WebRoot/files
upload.child.path = upload
channel.pic.child.path = upload/old
channel.newpic.child.path = upload/new
channel.bigpic.child.path = upload/big
music.pic.child.path = upload
zip.child.path = zip
zip.publish.child.path =freeListHtml
music.down.pic.path =music/images
</code></pre></div></div> <p><strong>properties文件的映射类(pathConfig.java)</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @className:PathConfig.java
 * @classDescription:从属性文件中获取各种路径
 * @author:wei.luo
 * @createTime:2012-3-23
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PathConfig</span> <span class="o">{</span>
    <span class="cm">/**
     * 初始给properties文件的路径赋值
     */</span>
    <span class="c1">//public static String PROPFILE_PATH = "../webapps/ayyc/WEB-INF/classes/config/properties/pathConfig.properties";</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">PROPFILE_PATH</span> <span class="o">=</span> <span class="s">"WEB-INF/classes/config/properties/pathConfig.properties"</span><span class="o">;</span>
    <span class="cm">/**
     * 存放pathConfig.properties中的属性
     */</span>
    <span class="kd">private</span> <span class="nc">Properties</span> <span class="n">props</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * 试听下载地址
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">LIS_INTERFACE</span><span class="o">=</span><span class="s">"http://aaaaa.vvvv.com/lis"</span><span class="o">;</span>
    <span class="cm">/**
     * 默认试听服务器ok
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">LISTENOK</span> <span class="o">=</span> <span class="s">"true"</span> <span class="o">;</span>
    <span class="cm">/**
     * 榜单列表页试听
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">LISTLISTENOK</span> <span class="o">=</span> <span class="s">"true"</span> <span class="o">;</span>
    <span class="cm">/**
     * 前端访问首页
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">MOBILEINDEX</span><span class="o">=</span><span class="s">"http://aaaaaaa. vvvv.com/mobile/index.html#a=gqxq"</span> <span class="o">;</span>
    <span class="cm">/**
     * 分离的文件的父目录的绝对地址
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">PARENT_PATH</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * 备份的分离的文件的父目录的绝对地址
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">BAK_PARENT_PATH</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * upload文件夹
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">UPLOAD_CHILD_PATH</span><span class="o">=</span><span class="s">"upload"</span><span class="o">;</span>
    <span class="cm">/**
     * 频道内置图片的的存放路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">CHANNEL_PIC_CHILD_PATH</span><span class="o">=</span><span class="s">"upload/old"</span><span class="o">;</span>
    <span class="cm">/**
     * 频道小图片的存放路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">CHANNEL_NEWPIC_CHILD_PATH</span><span class="o">=</span><span class="s">"upload/new"</span><span class="o">;</span>
    <span class="cm">/**
     * 频道大图片的存放路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">CHANNEL_BIGPIC_CHILD_PATH</span><span class="o">=</span><span class="s">"upload/big"</span><span class="o">;</span>
    <span class="cm">/**
     * 歌曲图片的存放路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">MUSIC_PIC_CHILD_PATH</span><span class="o">=</span><span class="s">"upload"</span><span class="o">;</span>
    <span class="cm">/**
     * zip文件的存放路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">ZIP_CHILD_PATH</span><span class="o">=</span><span class="s">"zip"</span><span class="o">;</span>
    <span class="cm">/**
     * zip文件的发布地址
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">ZIP_PUBLISH_CHILD_PATH</span><span class="o">=</span><span class="s">"freeListHtml"</span><span class="o">;</span>
    <span class="cm">/**
     * 下载的music图片存放地址
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">MUSIC_DOWN_PIC_PATH</span><span class="o">=</span><span class="s">"music/images"</span><span class="o">;</span>
    <span class="cm">/**
     * PathConfig对象
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">PathConfig</span> <span class="n">pathconfig</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * 把构造方法私有化
     * @param path    properties文件的物理路径
     */</span>
    <span class="kd">private</span> <span class="nf">PathConfig</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">){</span>
        <span class="n">props</span><span class="o">=</span><span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">getProperties</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">props</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"PROPFILE_PATH"</span><span class="o">,</span><span class="s">"property.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"LISTENOK"</span><span class="o">,</span><span class="s">"listenok"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"LISTLISTENOK"</span><span class="o">,</span><span class="s">"listlistenok"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"MOBILEINDEX"</span><span class="o">,</span><span class="s">"mobileindex"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"LIS_INTERFACE"</span><span class="o">,</span><span class="s">"lis.interface"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"PARENT_PATH"</span><span class="o">,</span><span class="s">"parent.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"BAK_PARENT_PATH"</span><span class="o">,</span><span class="s">"bak.parent.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"UPLOAD_CHILD_PATH"</span><span class="o">,</span><span class="s">"upload.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"CHANNEL_PIC_CHILD_PATH"</span><span class="o">,</span><span class="s">"channel.pic.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"CHANNEL_NEWPIC_CHILD_PATH"</span><span class="o">,</span><span class="s">"channel.newpic.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"CHANNEL_BIGPIC_CHILD_PATH"</span><span class="o">,</span><span class="s">"channel.bigpic.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"MUSIC_PIC_CHILD_PATH"</span><span class="o">,</span><span class="s">"music.pic.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"ZIP_CHILD_PATH"</span><span class="o">,</span><span class="s">"zip.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"ZIP_PUBLISH_CHILD_PATH"</span><span class="o">,</span><span class="s">"zip.publish.child.path"</span><span class="o">);</span>
            <span class="n">setFileValue</span><span class="o">(</span><span class="s">"MUSIC_DOWN_PIC_PATH"</span><span class="o">,</span><span class="s">"music.down.pic.path"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 给类的各个属性设值
     * @author wei.luo
     * @createTime 2012-3-31
     * @param fieldName 类属性名
     * @param namePath 路径的key名
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setFileValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">fieldName</span><span class="o">,</span><span class="nc">String</span> <span class="n">namePath</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">property_path</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">namePath</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isNotBlank</span><span class="o">(</span><span class="n">property_path</span><span class="o">)){</span>
            <span class="c1">//fieldName=property_path;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="nc">Field</span> <span class="n">field</span><span class="o">=</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
                <span class="n">field</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">property_path</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 从属性文件中读取key、value，初始化PathConfig
     * @author wei.luo
     * @createTime 2012-3-24
     * @param path properties文件的物理路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">initPathConfig</span><span class="o">(</span><span class="nc">String</span> <span class="n">path</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">pathconfig</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">pathconfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PathConfig</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 销毁pathconfig对象
     * @author wei.luo
     * @createTime 2012-3-31
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">(){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">pathconfig</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">pathconfig</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>属性控制类(pathConfigController.java)</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @className:PathConfigController.java
 * @classDescription:路径配置管理
 * @author:wei.luo
 * @createTime:2012-3-24下午09:19:32
 */</span>
<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/vvvv/pathConfig"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PathConfigController</span> <span class="kd">extends</span> <span class="nc">BaseController</span><span class="o">{</span>
    <span class="cm">/**
     * 注入commonService
     */</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ICommonService</span> <span class="n">commonService</span><span class="o">;</span>
    <span class="cm">/**
     * 显示配置属性列表
     * @author wei.luo
     * @createTime 2012-3-30
     * @param request request请求参数
     * @param response response请求参数
     * @param model 模型
     * @return 返回列表页面
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/list"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">list</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//销毁单例</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>
        <span class="c1">//初始化配置信息</span>
        <span class="nc">String</span> <span class="n">propFilePath</span><span class="o">=</span><span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="nc">PathConfig</span><span class="o">.</span><span class="na">PROPFILE_PATH</span><span class="o">);</span>
        <span class="c1">//初始化单例</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">initPathConfig</span><span class="o">(</span><span class="n">propFilePath</span><span class="o">);</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">pathConfigMap</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">getFields2</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">parentPathMap</span><span class="o">=</span><span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">childPathMap</span><span class="o">=</span><span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">otherConfigMap</span><span class="o">=</span><span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="nl">key:</span><span class="n">pathConfigMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">()){</span>
            <span class="k">if</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"PARENT"</span><span class="o">)){</span>
                <span class="n">parentPathMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">pathConfigMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"CHILD"</span><span class="o">)){</span>
                <span class="n">childPathMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">pathConfigMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="k">else</span><span class="o">{</span>
                <span class="n">otherConfigMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">pathConfigMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"parentPathMap"</span><span class="o">,</span> <span class="n">parentPathMap</span><span class="o">);</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"childPathMap"</span><span class="o">,</span> <span class="n">childPathMap</span><span class="o">);</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"otherConfigMap"</span><span class="o">,</span> <span class="n">otherConfigMap</span><span class="o">);</span>
        <span class="c1">//String currentPage = request.getRequestURI().toString();</span>
        <span class="c1">//request.getSession().setAttribute("currentPage", currentPage);</span>
        <span class="k">return</span> <span class="s">"manage/systemManage/listConfig.jsp"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 编辑配置属性
     * @author wei.luo
     * @createTime 2012-3-30
     * @param request request请求参数
     * @param response response请求参数
     * @param model 模 型
     * @param config 配置
     * @return 返回列表页面
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"/edit"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">editPathConfig</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
                                 <span class="nc">Model</span> <span class="n">model</span><span class="o">,</span><span class="nc">String</span> <span class="n">config</span><span class="cm">/*,@PathVariable("config") String config*/</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Assert</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="s">"No config specified"</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isBlank</span><span class="o">(</span><span class="n">config</span><span class="o">)</span> <span class="o">||</span> <span class="n">request</span><span class="o">==</span><span class="kc">null</span> <span class="o">||</span> <span class="n">response</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
<span class="c1">//            String currentPage = (String) this.getSessionAttribute(request, "currentPage");</span>
<span class="c1">//            this.sendRedirect(response, currentPage);</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">config</span><span class="o">=</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">substringBetween</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="s">"["</span><span class="o">,</span> <span class="s">"]"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">configKey</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"@"</span><span class="o">)[</span><span class="mi">0</span><span class="o">];</span>
        <span class="nc">String</span> <span class="n">configValue</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"@"</span><span class="o">)[</span><span class="mi">1</span><span class="o">];</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"configKey"</span><span class="o">,</span> <span class="n">configKey</span><span class="o">);</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"configValue"</span><span class="o">,</span> <span class="n">configValue</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">"manage/systemManage/editConfig.jsp"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 跳到添加配置属性页
     * @author wei.luo
     * @createTime 2012-3-30
     * @param request request请求
     * @param response    response请求
     * @param model    模型
     * @return 跳转到添加页面
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"/toAdd"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">addPathConfig</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Model</span> <span class="n">model</span><span class="o">){</span>
        <span class="k">return</span> <span class="s">"manage/systemManage/addConfig.jsp"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 添加配置
     * @author wei.luo
     * @createTime 2012-3-31
     * @param request    request请求参数
     * @param response    response 请求参数
     * @param model    模型
     * @param configKey    键
     * @param configValue    值 
     * @return    返回列表页面
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/add"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">addConfig</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
                            <span class="nc">Model</span> <span class="n">model</span><span class="o">,</span> <span class="nc">String</span> <span class="n">configKey</span><span class="o">,</span><span class="nc">String</span> <span class="n">configValue</span><span class="o">)</span> <span class="o">{</span>
<span class="c1">//        if(StringUtils.isNotBlank(configKey) &amp;&amp; StringUtils.isNotBlank(configValue) &amp;&amp; request!=null &amp;&amp; response!=null){</span>
<span class="c1">//            try {</span>
<span class="c1">//                String propsPath=PathConfig.PROPFILE_PATH;</span>
<span class="c1">//                PathConfig.destroy();</span>
<span class="c1">//                PathConfig.initPathConfig(PathConfig.PROPFILE_PATH);</span>
<span class="c1">//                //--动态创建静态属性-------</span>
<span class="c1">//                </span>
<span class="c1">//                </span>
<span class="c1">//                PropertiesUtil.write(propsPath, configKey,configValue);</span>
<span class="c1">//            }catch (Exception e) {</span>
<span class="c1">//                e.printStackTrace();</span>
<span class="c1">//            }</span>
<span class="c1">//        }</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 修改配置属性
     * 注意要添加对properties文件的修改
     * @author wei.luo
     * @createTime 2012-3-30
     * @param request    request请求参数
     * @param response    response请求参数
     * @param model     模型
     * @param configKey 键
     * @param configValue 值
     * @return 返回列表页面
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/alter"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">changePathConfig</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
                                   <span class="nc">Model</span> <span class="n">model</span><span class="o">,</span> <span class="nc">String</span> <span class="n">configKey</span><span class="o">,</span><span class="nc">String</span> <span class="n">configValue</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">messageList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isNotBlank</span><span class="o">(</span><span class="n">configKey</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">isNotBlank</span><span class="o">(</span><span class="n">configValue</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">request</span><span class="o">!=</span><span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">response</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="nc">String</span> <span class="n">oldConfigValue</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">getFieldValue</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">configKey</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">inDir</span><span class="o">=</span><span class="n">oldConfigValue</span><span class="o">+</span><span class="s">"/"</span><span class="o">;</span>
            <span class="nc">String</span> <span class="n">outDir</span><span class="o">=</span><span class="n">configValue</span><span class="o">+</span><span class="s">"/"</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="s">"PARENT_PATH"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">configKey</span><span class="o">)){</span>
                    <span class="nc">FileUtil</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">inDir</span><span class="o">,</span> <span class="n">outDir</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">configKey</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"CHILD_PATH"</span><span class="o">)){</span>
                    <span class="nc">FileUtil</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">PARENT_PATH</span><span class="o">+</span><span class="s">"/"</span><span class="o">+</span><span class="n">inDir</span><span class="o">,</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">PARENT_PATH</span><span class="o">+</span><span class="s">"/"</span><span class="o">+</span><span class="n">outDir</span> <span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">message</span><span class="o">=</span><span class="s">"拷贝"</span><span class="o">+</span><span class="n">inDir</span><span class="o">+</span><span class="s">"目录下文件到"</span><span class="o">+</span><span class="n">outDir</span><span class="o">+</span><span class="s">"目录下失败"</span><span class="o">;</span>
                <span class="n">messageList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="c1">//修改类中的static属性值</span>
            <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">changeFields</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">configKey</span><span class="o">,</span><span class="n">configValue</span><span class="o">);</span>
            <span class="c1">//修改properties文件中的属性值</span>
            <span class="nc">String</span> <span class="n">propertyPath</span><span class="o">=</span><span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="nc">PathConfig</span><span class="o">.</span><span class="na">PROPFILE_PATH</span><span class="o">);</span>
            <span class="n">configKey</span><span class="o">=</span><span class="n">configKey</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s">"_"</span><span class="o">,</span> <span class="s">"."</span><span class="o">);</span>
            <span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">,</span> <span class="n">configKey</span><span class="o">,</span> <span class="n">configValue</span><span class="o">);</span>
            <span class="c1">//重新销毁再加载</span>
            <span class="nc">PathConfig</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>
            <span class="nc">PathConfig</span><span class="o">.</span><span class="na">initPathConfig</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">);</span>
            <span class="c1">//request.getRequestDispatcher("manage/pathConfig/list.do").forward(request, response);</span>
        <span class="o">}</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"messageList"</span><span class="o">,</span> <span class="n">messageList</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 将路径切到tomcat容器
     * @author wei.luo
     * @createTime 2012-4-7
     * @param request    request请求
     * @param response    response请求
     * @param model    模型
     * @return 返回列表页
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/switch2tomcat"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">switch2tomcat</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Model</span> <span class="n">model</span><span class="o">){</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">messageList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">String</span> <span class="n">parentKey</span> <span class="o">=</span> <span class="s">"PARENT_PATH"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">bakParentKey</span> <span class="o">=</span> <span class="s">"BAK_PARENT_PATH"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">oldConfigValue</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">getFieldValue</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">parentKey</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">webRootPath</span><span class="o">=</span><span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="s">""</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">oldConfigValue</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">webRootPath</span><span class="o">)){</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//更新配置类中的属性</span>
        <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">changeFields</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">bakParentKey</span><span class="o">,</span><span class="n">webRootPath</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">changeFields</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">parentKey</span><span class="o">,</span><span class="n">webRootPath</span><span class="o">);</span>
        <span class="c1">//把分离的文件拷到tomcat容器的webRoot目录下</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">FileUtil</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">oldConfigValue</span><span class="o">,</span><span class="n">webRootPath</span> <span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">message</span><span class="o">=</span><span class="s">"拷贝"</span><span class="o">+</span><span class="n">oldConfigValue</span><span class="o">+</span><span class="s">"到"</span><span class="o">+</span><span class="n">webRootPath</span><span class="o">+</span><span class="s">"下失败！"</span><span class="o">;</span>
            <span class="n">messageList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">//获得properties属性文件的路径,并设置属性值</span>
        <span class="nc">String</span> <span class="n">propertyPath</span><span class="o">=</span><span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="nc">PathConfig</span><span class="o">.</span><span class="na">PROPFILE_PATH</span><span class="o">);</span>
        <span class="n">parentKey</span><span class="o">=</span><span class="n">parentKey</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s">"_"</span><span class="o">,</span> <span class="s">"."</span><span class="o">);</span>
        <span class="n">bakParentKey</span><span class="o">=</span><span class="n">bakParentKey</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s">"_"</span><span class="o">,</span> <span class="s">"."</span><span class="o">);</span>
        <span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">,</span><span class="n">parentKey</span><span class="o">,</span> <span class="n">webRootPath</span><span class="o">);</span>
        <span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">,</span><span class="n">bakParentKey</span><span class="o">,</span> <span class="n">oldConfigValue</span><span class="o">);</span>
        <span class="c1">//重新销毁再加载</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">initPathConfig</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"messageList"</span><span class="o">,</span> <span class="n">messageList</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 从tomcat容器切回分离目录
     * @author wei.luo
     * @createTime 2012-4-7
     * @param request request请求
     * @param response response请求
     * @param model 模型
     * @return 列表页
     */</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/switch2nginx"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">switch2nginx</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Model</span> <span class="n">model</span><span class="o">){</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">messageList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">"PARENT_PATH"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">tomcatPath</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="s">""</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">nginxPath</span> <span class="o">=</span> <span class="nc">PathConfig</span><span class="o">.</span><span class="na">BAK_PARENT_PATH</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span><span class="n">tomcatPath</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">nginxPath</span><span class="o">)){</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">pathConfigMap</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">commonService</span><span class="o">.</span><span class="na">getFields2</span><span class="o">(</span><span class="nc">PathConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="nl">key1:</span><span class="n">pathConfigMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">()){</span>
            <span class="nc">String</span> <span class="n">inPath</span><span class="o">=</span><span class="n">tomcatPath</span><span class="o">+</span><span class="s">"/"</span><span class="o">+</span><span class="n">pathConfigMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key1</span><span class="o">)+</span><span class="s">"/"</span><span class="o">;</span>
            <span class="nc">String</span> <span class="n">outPath</span><span class="o">=</span><span class="n">nginxPath</span><span class="o">+</span><span class="s">"/"</span><span class="o">+</span><span class="n">pathConfigMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key1</span><span class="o">)+</span><span class="s">"/"</span><span class="o">;</span>
            <span class="k">if</span><span class="o">(</span><span class="n">key1</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"CHILD"</span><span class="o">)){</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="nc">FileUtil</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">inPath</span><span class="o">,</span> <span class="n">outPath</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">String</span> <span class="n">message</span><span class="o">=</span><span class="s">"拷贝"</span><span class="o">+</span><span class="n">inPath</span><span class="o">+</span><span class="s">"到"</span><span class="o">+</span><span class="n">outPath</span><span class="o">+</span><span class="s">"下失败！"</span><span class="o">;</span>
                    <span class="n">messageList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="nc">FileUtil</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">inPath</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="nc">String</span> <span class="n">message</span><span class="o">=</span><span class="s">"删除"</span><span class="o">+</span><span class="n">inPath</span><span class="o">+</span><span class="s">"失败！"</span><span class="o">;</span>
                    <span class="n">messageList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="c1">//获得properties属性文件的路径</span>
        <span class="nc">String</span> <span class="n">propertyPath</span><span class="o">=</span><span class="k">this</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="nc">PathConfig</span><span class="o">.</span><span class="na">PROPFILE_PATH</span><span class="o">);</span>
        <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">().</span><span class="na">replace</span><span class="o">(</span><span class="s">"_"</span><span class="o">,</span> <span class="s">"."</span><span class="o">);</span>
        <span class="nc">PropertiesUtil</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">,</span><span class="n">key</span><span class="o">,</span> <span class="n">nginxPath</span><span class="o">);</span>
        <span class="c1">//重新销毁再加载</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>
        <span class="nc">PathConfig</span><span class="o">.</span><span class="na">initPathConfig</span><span class="o">(</span><span class="n">propertyPath</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"messageList"</span><span class="o">,</span> <span class="n">messageList</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">model</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>页面(javascript &amp; css)</strong></p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;STYLE</span> <span class="na">type=</span><span class="s">text/css</span><span class="nt">&gt;</span>
    {
        FONT-SIZE
        :
                12px
    }
    #operatorTree A {
        COLOR: #566984;
        TEXT-DECORATION: none
    }
    .STYLE2 {
        font-size: x-large
    }
<span class="nt">&lt;/STYLE&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span> <span class="na">media=</span><span class="s">"all"</span><span class="nt">&gt;</span>
    <span class="nt">body</span><span class="o">,</span><span class="nt">div</span> <span class="p">{</span>
        <span class="nl">font-size</span><span class="p">:</span> <span class="m">12px</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.rw</span><span class="p">{</span><span class="nl">background-image</span><span class="p">:</span> <span class="sx">url(${ctx}/images/cs.jpg)</span><span class="p">;}</span><span class="err">}</span>
<span class="nt">&lt;/style&gt;</span>
^_^ ^_^ ^_^
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="kd">function</span> <span class="nx">changeCss</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cn</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">className</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">cn</span><span class="o">!=</span><span class="dl">""</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">setAttribute</span><span class="p">(</span><span class="dl">"</span><span class="s2">oldclass</span><span class="dl">"</span><span class="p">,</span> <span class="nx">cn</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">recoverCss</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">old</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">setAttribute</span><span class="p">(</span><span class="dl">"</span><span class="s2">oldclass</span><span class="dl">"</span><span class="p">);</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">className</span><span class="o">=</span><span class="dl">""</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">old</span><span class="o">!=</span><span class="dl">""</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">rw</span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="p">).</span><span class="nx">className</span><span class="o">=</span><span class="nx">old</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div> <p><strong>页面(jsp)</strong></p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;TABLE</span> <span class="na">height=</span><span class="s">"100%"</span> <span class="na">cellSpacing=</span><span class="s">0</span> <span class="na">cellPadding=</span><span class="s">0</span> <span class="na">width=</span><span class="s">"100%"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;TBODY&gt;</span>
    <span class="nt">&lt;TR&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">width=</span><span class="s">10</span> <span class="na">height=</span><span class="s">29</span><span class="nt">&gt;&lt;IMG</span> <span class="na">src=</span><span class="s">"${ctx }/vvvv/index/Left.files/bg_left_tl.gif"</span><span class="nt">&gt;&lt;/TD&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">style=</span><span class="s">"FONT-SIZE: 18px; BACKGROUND-IMAGE: url(${ctx }/vvvv/images/bg_left_tc.gif); COLOR: white; FONT-FAMILY: system"</span><span class="nt">&gt;</span>路径配置<span class="nt">&lt;/TD&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">width=</span><span class="s">10</span><span class="nt">&gt;&lt;IMG</span> <span class="na">src=</span><span class="s">"${ctx }/vvvv/index/Left.files/bg_left_tr.gif"</span><span class="nt">&gt;&lt;/TD&gt;</span>
    <span class="nt">&lt;/TR&gt;</span>
    <span class="nt">&lt;TR&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">colspan=</span><span class="s">"3"</span> <span class="na">style=</span><span class="s">"PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-TOP: 10px; BACKGROUND-COLOR: white"</span> <span class="na">vAlign=</span><span class="s">"top"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"margin-left:5%;float:left;display:inline-block;"</span><span class="nt">&gt;&lt;b&gt;&lt;font</span> <span class="na">color=</span><span class="s">"green"</span><span class="nt">&gt;</span>父目录(绝对路径)<span class="nt">&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;</span>
            <span class="nt">&lt;TABLE</span> <span class="na">class=</span><span class="s">gridView</span> <span class="na">id=</span><span class="s">ctl00_ContentPlaceHolder2_GridView1</span>
                   <span class="na">style=</span><span class="s">"WIDTH: 100%; BORDER-COLLAPSE: collapse"</span> <span class="na">cellSpacing=</span><span class="s">0</span> <span class="na">rules=</span><span class="s">all</span>
                   <span class="na">border=</span><span class="s">0</span> <span class="nt">&gt;</span>
                <span class="nt">&lt;TR</span> <span class="nt">&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>序号 <span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>key<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>value<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>操作<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;/TR&gt;</span>
                <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"i"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;c:forEach</span> <span class="na">items=</span><span class="s">"${parentPathMap}"</span> <span class="na">var=</span><span class="s">"pathConfig"</span> <span class="na">varStatus=</span><span class="s">"s"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">"${pathConfig.key ne '' &amp;&amp; pathConfig.key ne null}"</span> <span class="nt">&gt;</span>
                        <span class="nt">&lt;tr</span> <span class="na">id=</span><span class="s">"rw${i}"</span> <span class="na">onmouseover=</span><span class="s">"changeCss(${i})"</span> <span class="na">onmouseout=</span><span class="s">"recoverCss(${i})"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${i}<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${pathConfig.key }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;</span>${pathConfig.value }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">"${ctx}/vvvv/pathConfig/edit.do?config=[${pathConfig.key}@${pathConfig.value }]"</span> <span class="nt">&gt;</span>编辑<span class="nt">&lt;/a&gt;</span> <span class="c">&lt;!-- |
                     &lt;a href="#" onclick="if(confirm( '你确定删除吗? '))location.href='${ctx}/vvvv/pathConfig/delete?configName=${pathConfig.key }';return false;"&gt;删除&lt;/a&gt; --&gt;</span>
                            <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;/tr&gt;</span>
                        <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"i"</span> <span class="na">value=</span><span class="s">"${i+1}"</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/c:if&gt;</span>
                <span class="nt">&lt;/c:forEach&gt;</span>
                <span class="c">&lt;!-- 结束 --&gt;</span>
            <span class="nt">&lt;/TABLE&gt;</span>
        <span class="nt">&lt;/TD&gt;</span>
    <span class="nt">&lt;/TR&gt;</span>
    <span class="nt">&lt;TR&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">colspan=</span><span class="s">"3"</span> <span class="na">style=</span><span class="s">"PADDING-RIGHT: 10px; PADDING-LEFT: 10px; BACKGROUND-COLOR: white"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"margin-left:5%;float:left;display:inline-block;"</span><span class="nt">&gt;&lt;b&gt;&lt;font</span> <span class="na">color=</span><span class="s">"green"</span><span class="nt">&gt;</span>子目录<span class="nt">&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;</span>
            <span class="nt">&lt;TABLE</span> <span class="na">class=</span><span class="s">gridView</span> <span class="na">id=</span><span class="s">ctl00_ContentPlaceHolder2_GridView1</span>
                   <span class="na">style=</span><span class="s">"WIDTH: 100%; BORDER-COLLAPSE: collapse"</span> <span class="na">cellSpacing=</span><span class="s">0</span> <span class="na">rules=</span><span class="s">all</span>
                   <span class="na">border=</span><span class="s">0</span> <span class="nt">&gt;</span>
                <span class="nt">&lt;TR</span> <span class="nt">&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>序号 <span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>key<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>value<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>操作<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;/TR&gt;</span>
                <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"j"</span> <span class="na">value=</span><span class="s">"100"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;c:forEach</span> <span class="na">items=</span><span class="s">"${childPathMap}"</span> <span class="na">var=</span><span class="s">"pathConfig"</span> <span class="na">varStatus=</span><span class="s">"s"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">"${pathConfig.key ne '' &amp;&amp; pathConfig.key ne null}"</span> <span class="nt">&gt;</span>
                        <span class="nt">&lt;tr</span> <span class="na">id=</span><span class="s">"rw${j}"</span> <span class="na">onmouseover=</span><span class="s">"changeCss(${j})"</span> <span class="na">onmouseout=</span><span class="s">"recoverCss(${j})"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${j}<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${pathConfig.key }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;</span>${pathConfig.value }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">onclick=</span><span class="s">"if(confirm( '你确定要编辑子目录吗?(建议不要编辑子目录) '))location.href='${ctx}/vvvv/pathConfig/edit.do?config=[${pathConfig.key}@${pathConfig.value }]'"</span> <span class="nt">&gt;</span>编辑<span class="nt">&lt;/a&gt;</span> <span class="c">&lt;!-- |
                         &lt;a href="#" onclick="if(confirm( '你确定删除吗? '))location.href='${ctx}/vvvv/pathConfig/delete?configName=${pathConfig.key }';return false;"&gt;删除&lt;/a&gt; --&gt;</span>
                            <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;/tr&gt;</span>
                        <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"j"</span> <span class="na">value=</span><span class="s">"${j+1}"</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/c:if&gt;</span>
                <span class="nt">&lt;/c:forEach&gt;</span>
                <span class="c">&lt;!-- 结束 --&gt;</span>
            <span class="nt">&lt;/TABLE&gt;</span>
        <span class="nt">&lt;/TD&gt;</span>
    <span class="nt">&lt;/TR&gt;</span>
    <span class="nt">&lt;TR&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">colspan=</span><span class="s">"3"</span> <span class="na">style=</span><span class="s">"PADDING-RIGHT: 10px; PADDING-LEFT: 10px; BACKGROUND-COLOR: white"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"margin-left:5%;float:left;display:inline-block;"</span><span class="nt">&gt;&lt;b&gt;&lt;font</span> <span class="na">color=</span><span class="s">"green"</span><span class="nt">&gt;</span>其它配置<span class="nt">&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;</span>
            <span class="nt">&lt;TABLE</span> <span class="na">class=</span><span class="s">gridView</span> <span class="na">id=</span><span class="s">ctl00_ContentPlaceHolder2_GridView1</span>
                   <span class="na">style=</span><span class="s">"WIDTH: 100%; BORDER-COLLAPSE: collapse"</span> <span class="na">cellSpacing=</span><span class="s">0</span> <span class="na">rules=</span><span class="s">all</span>
                   <span class="na">border=</span><span class="s">0</span> <span class="nt">&gt;</span>
                <span class="nt">&lt;TR</span> <span class="nt">&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>序号 <span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridViewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>key<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>value<span class="nt">&lt;/th&gt;</span>
                    <span class="nt">&lt;th</span> <span class="na">class=</span><span class="s">"gridviewHeader"</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>操作<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;/TR&gt;</span>
                <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"k"</span> <span class="na">value=</span><span class="s">"200"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;c:forEach</span> <span class="na">items=</span><span class="s">"${otherConfigMap}"</span> <span class="na">var=</span><span class="s">"pathConfig"</span> <span class="na">varStatus=</span><span class="s">"s"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">"${pathConfig.key ne '' &amp;&amp; pathConfig.key ne null}"</span> <span class="nt">&gt;</span>
                        <span class="nt">&lt;tr</span> <span class="na">id=</span><span class="s">"rw${k}"</span> <span class="na">onmouseover=</span><span class="s">"changeCss(${k})"</span> <span class="na">onmouseout=</span><span class="s">"recoverCss(${k})"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${k}<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td</span> <span class="nt">&gt;</span>${pathConfig.key }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;</span>${pathConfig.value }<span class="nt">&lt;/td&gt;</span>
                            <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">"${ctx}/vvvv/pathConfig/edit.do?config=[${pathConfig.key}@${pathConfig.value }]"</span> <span class="nt">&gt;</span>编辑<span class="nt">&lt;/a&gt;</span> <span class="c">&lt;!-- |
                         &lt;a href="#" onclick="if(confirm( '你确定删除吗? '))location.href='${ctx}/vvvv/pathConfig/delete?configName=${pathConfig.key }';return false;"&gt;删除&lt;/a&gt; --&gt;</span>
                            <span class="nt">&lt;/td&gt;</span>
                        <span class="nt">&lt;/tr&gt;</span>
                        <span class="nt">&lt;c:set</span> <span class="na">var=</span><span class="s">"k"</span> <span class="na">value=</span><span class="s">"${k+1}"</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/c:if&gt;</span>
                <span class="nt">&lt;/c:forEach&gt;</span>
                <span class="c">&lt;!-- 结束 --&gt;</span>
            <span class="nt">&lt;/TABLE&gt;</span>
            <span class="nt">&lt;p&gt;&lt;div</span> <span class="na">style=</span><span class="s">"margin-left:5%;float:right;display:inline-block;"</span><span class="nt">&gt;&lt;b&gt;&lt;font</span> <span class="na">color=</span><span class="s">"red"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">onclick=</span><span class="s">"if(confirm( '你确定要将分离的文件切到tomcat容器中去吗? '))location.href='${ctx}/vvvv/pathConfig/switch2tomcat.do'"</span>
                   <span class="na">value=</span><span class="s">"将分离的文件切回tomcat容器中"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">onclick=</span><span class="s">"if(confirm( '你确定要将tomcat容器中可分离的文件切到nginx指定目录去吗? '))location.href='${ctx}/vvvv/pathConfig/switch2nginx.do'"</span>
                   <span class="na">value=</span><span class="s">"将tomcat容器中可分离的文件切到nginx指定目录"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/TD&gt;</span>
    <span class="nt">&lt;/TR&gt;</span>
    <span class="nt">&lt;TR&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">width=</span><span class="s">10</span><span class="nt">&gt;&lt;IMG</span> <span class="na">src=</span><span class="s">"${ctx }/vvvv/index/Left.files/bg_left_bl.gif"</span><span class="nt">&gt;&lt;/TD&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">style=</span><span class="s">"BACKGROUND-IMAGE: url(${ctx }/vvvv/images/bg_left_bc.gif)"</span><span class="nt">&gt;&lt;/TD&gt;</span>
        <span class="nt">&lt;TD</span> <span class="na">width=</span><span class="s">10</span><span class="nt">&gt;&lt;IMG</span> <span class="na">src=</span><span class="s">"${ctx }/vvvv/index/Left.files/bg_left_br.gif"</span><span class="nt">&gt;&lt;/TD&gt;</span>
    <span class="nt">&lt;/TR&gt;</span>
    <span class="nt">&lt;/TBODY&gt;</span>
<span class="nt">&lt;/TABLE&gt;</span>
</code></pre></div></div> <p><strong>截图一张</strong><br /> <img src="https://raw.githubusercontent.com/luowei/list/gh-pages/images/java/base/article_90.jpg" alt="截图一张" /></p> <h3 id="方案二">方案二</h3> <p><strong>说明：</strong>把配置信息，存储在配置的Bean中，再把Bean以集合的形式存储于Map当中，再将Map转成Json字符串，存储于集合当中。<br /> <strong>配置工具类</strong> ： 配置工具类，用于获得配置信息存储配置信息。</p> <p><strong>ConfigUtil.java</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.vvvv.musicsns.util</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.Gson</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.reflect.TypeToken</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.vvvv.musicsns.bean.ConfigBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.vvvv.musicsns.config.FinalConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.StringUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Type</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="cm">/**
 * config util 配置工具类
 * User: luowei
 * Date: 12-7-8
 * Time: 下午5:54
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfigUtil</span> <span class="o">{</span>
    <span class="cm">/**
     * 记录器
     */</span>
    <span class="kd">protected</span> <span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Logger</span><span class="o">)</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">ConfigUtil</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="cm">/**
     * ConfigUtil实例
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ConfigUtil</span> <span class="n">configUtil</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * config json string,converted from Map&lt;String,ConfigBean&lt;T&gt;&gt;
     */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">configJson</span> <span class="o">=</span><span class="kc">null</span><span class="o">;</span>
    <span class="cm">/**
     * 配置工具类的map
     */</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">ConfigBean</span><span class="o">&gt;</span> <span class="n">configBeanMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">ConfigBean</span><span class="o">&gt;();</span>
    <span class="cm">/**
     * 构造方法
     * @param configJson json字符串
     */</span>
    <span class="kd">private</span> <span class="nf">ConfigUtil</span><span class="o">(</span><span class="nc">String</span> <span class="n">configJson</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">configJson</span> <span class="o">=</span> <span class="n">configJson</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * 拿配置文件路径
     * @return 返回路径
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getConfigFilePath</span><span class="o">(){</span>
        <span class="nc">String</span> <span class="n">configFilePath</span> <span class="o">=</span> <span class="nc">FinalConfig</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="nc">FinalConfig</span><span class="o">.</span><span class="na">CONFIG_JSONFILE_NAME</span><span class="o">).</span><span class="na">getPath</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="c1">// 判断系统 linux，windows</span>
        <span class="k">if</span> <span class="o">(</span><span class="s">"\\"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">File</span><span class="o">.</span><span class="na">separator</span><span class="o">)){</span>
            <span class="n">configFilePath</span> <span class="o">=</span> <span class="n">configFilePath</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"%20"</span> <span class="o">,</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span> <span class="k">if</span> <span class="o">(</span> <span class="s">"/"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">File</span><span class="o">.</span><span class="na">separator</span><span class="o">)){</span>
            <span class="n">configFilePath</span> <span class="o">=</span> <span class="s">"/"</span><span class="o">+</span> <span class="n">configFilePath</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"%20"</span> <span class="o">,</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">configFilePath</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * get configJson string , sington
     * @return 配置的json字符串
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getConfigJson</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">configUtil</span><span class="o">.</span><span class="na">configJson</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * set configJson string to config file
     * @param configJson 配置的json字符串
     * @return 成功或失败
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Boolean</span> <span class="nf">setConfigJson</span><span class="o">(</span><span class="nc">String</span> <span class="n">configJson</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">getConfigFilePath</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">configUtil</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">configUtil</span> <span class="o">=</span> <span class="n">initConfigUtil</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">configUtil</span><span class="o">.</span><span class="na">configJson</span> <span class="o">=</span> <span class="n">configJson</span><span class="o">;</span>
        <span class="nc">Boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="nc">FileUtil</span><span class="o">.</span><span class="na">writeString2File</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">configJson</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">flag</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * get config bean Map&lt;String,ConfigBean&lt;T&gt;&gt; ,such as: &lt;configBean.getKey(),configBean&gt;
     * @return 配置信息map
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">ConfigBean</span><span class="o">&gt;</span> <span class="nf">getConfigMap</span><span class="o">(){</span>
        <span class="k">if</span><span class="o">(</span><span class="kc">null</span> <span class="o">==</span> <span class="n">configUtil</span><span class="o">){</span>
            <span class="n">initConfigUtil</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">configStr</span> <span class="o">=</span> <span class="nc">ConfigUtil</span><span class="o">.</span><span class="na">getConfigJson</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isNotBlank</span><span class="o">(</span><span class="n">configStr</span><span class="o">)){</span>
            <span class="nc">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Gson</span><span class="o">();</span>
            <span class="nc">Type</span> <span class="n">configBeanType</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TypeToken</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">ConfigBean</span><span class="o">&gt;&gt;(){}.</span><span class="na">getType</span><span class="o">();</span>
            <span class="n">configUtil</span><span class="o">.</span><span class="na">configBeanMap</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">configStr</span><span class="o">,</span><span class="n">configBeanType</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">configUtil</span><span class="o">.</span><span class="na">configBeanMap</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * set configBeanMap to config file
     * @param configBeanMap ConfigBean的map
     * @return 成功或失败
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Boolean</span> <span class="nf">setConfigMap</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">ConfigBean</span><span class="o">&gt;</span> <span class="n">configBeanMap</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="kc">null</span> <span class="o">==</span> <span class="n">configUtil</span><span class="o">){</span>
            <span class="n">initConfigUtil</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="nc">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Gson</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">configStr</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">configBeanMap</span><span class="o">);</span>
        <span class="n">configUtil</span><span class="o">.</span><span class="na">configBeanMap</span> <span class="o">=</span> <span class="n">configBeanMap</span><span class="o">;</span>
        <span class="nc">Boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="nc">ConfigUtil</span><span class="o">.</span><span class="na">setConfigJson</span><span class="o">(</span><span class="n">configStr</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">flag</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * init configUtil instance
     * @return 配置实例
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="nc">ConfigUtil</span> <span class="nf">initConfigUtil</span><span class="o">(){</span>
<span class="c1">//if(configUtil==null){</span>
        <span class="nc">String</span> <span class="n">configFilePath</span> <span class="o">=</span> <span class="n">getConfigFilePath</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">jsonStr</span> <span class="o">=</span> <span class="nc">FileUtil</span><span class="o">.</span><span class="na">readStringFromFile</span><span class="o">(</span><span class="n">configFilePath</span><span class="o">);</span>
        <span class="n">configUtil</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ConfigUtil</span><span class="o">(</span><span class="n">jsonStr</span><span class="o">);</span>
<span class="c1">// }</span>
        <span class="k">return</span> <span class="n">configUtil</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="cm">/**
     * destroy configUtil instance
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">(){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">configUtil</span> <span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
            <span class="n">configUtil</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>配置名称标识</strong><br /> 配置的名称标识，标识了配置的名称，用于程序拿出指定的名称的配置。</p> <p><strong>FinalConfig.java</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.vvvv.musicsns.config</span><span class="o">;</span>
<span class="cm">/**
 * the config properties defined in this class
 * User: luowei
 * Date: 12-7-8
 * Time: 下午1:08
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FinalConfig</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">AAAAA</span> <span class="o">=</span> <span class="s">"aaaaa"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">BBBBB</span> <span class="o">=</span> <span class="s">"bbbbb"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">CCCCC</span> <span class="o">=</span> <span class="s">"ccccc"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>配置Bean ConfigBean.java</strong></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.vvvv.musicsns.bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
<span class="cm">/**
 * config bean ,to store config info
 * User: luowei
 * Date: 12-7-8
 * Time: 下午1:13
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfigBean</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="cm">/**
     * 配置名称
     */</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="cm">/**
     * key值
     */</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">key</span><span class="o">;</span>
    <span class="cm">/**
     * value值
     */</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">value</span><span class="o">;</span>
    <span class="cm">/**
     * 描述信息
     */</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">describe</span><span class="o">;</span>
<span class="err">…………</span><span class="n">get</span><span class="err">、</span><span class="n">set方法</span><span class="err">…………</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>使用 config.json</strong></p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"aaaaa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaaaa"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"域名"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://aa.com/aaaa"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"describe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"音乐社区域名,外网：http://aa.vvvv.com"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"bbbbb"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bbbbb"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"域名"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://aa.com/aaaa"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"describe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"音乐社区域名,外网：http://aa.vvvv.com"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"ccccc"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ccccc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"域名"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://aa.com/aaaa"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"describe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"音乐社区域名,外网：http://aa.vvvv.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p><span class="site-footer-credits">版权所有，转载请注明出处 <a href="https://luowei.github.io/list">luowei.github.io</a>.</span></p> <link rel="stylesheet" href="/list/assets/css/font-awesome.min.css?ver=20151122" /> <!--[if IE 7 ]><link rel="stylesheet" href="/list/assets/css/font-awesome-ie7.min.css?ver=20151122"><![endif]--> <div style="float: right"> <span id="share"> <a class="wechat" target="_blank" title="分享到微信" href="https://chart.apis.google.com/chart?cht=qr&amp;chs=300x300&amp;chl=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html"><i class="icon-large icon-wechat"></i></a> <a class="weibo" target="_blank" title="分享到微博" href="http://service.weibo.com/share/share.php?title=Java-Java中对配置数据的存储方案 - 知不知&amp;url=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html&amp;type=3&amp;searchPic=1"><i class="icon-large icon-weibo"></i></a> <a class="qzone" target="_blank" title="分享到 QQ 空间" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html&amp;title=Java-Java中对配置数据的存储方案 - 知不知&amp;summary=Java中对配置数据的存储方案&amp;site=/list"><i class="icon-large icon-qzone"></i></a> <a class="twitter" target="_blank" title="Share to Twitter" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html&amp;text=Java-Java中对配置数据的存储方案 - 知不知&amp;via=luowei010101"><i class="icon-large icon-twitter"></i></a> <a class="facebook" target="_blank" title="Share to Facebook" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html&amp;t=Java-Java中对配置数据的存储方案 - 知不知"><i class="icon-large icon-facebook-sign"></i></a> <a class="googleplus" target="_blank" title="Share to Google+" href="https://plus.google.com/share?url=https%3A%2F%2Fluowei.github.io%2Flist%2Fdocs%2Fjava%2F2012-01-17-Java%25E4%25B8%25AD%25E5%25AF%25B9%25E9%2585%258D%25E7%25BD%25AE%25E6%2595%25B0%25E6%258D%25AE%25E7%259A%2584%25E5%25AD%2598%25E5%2582%25A8%25E6%2596%25B9%25E6%25A1%2588.html"><i class="icon-large icon-google-plus-sign"></i></a> </span> </div> <hr /> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" /> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <div id="gitalk-container"></div> <script type="text/javascript"> var gitalk = new Gitalk({ clientID: '9d5ee666269c252cf949', clientSecret: '728cd598f1fca9d8c1df1dfa300057883a3a8676', repo: 'list', owner: 'luowei', admin: ['luowei'], id: decodeURI('Java-Java中对配置数据的存储方案'), distractionFreeMode: false }); gitalk.render('gitalk-container'); </script> <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1277627361'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s96.cnzz.com/z_stat.php%3Fid%3D1277627361%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script> <footer class="site-footer"> <span class="site-footer-owner"><a href="https://luowei.github.io/list">知不知</a> is maintained by <a href="http://luowei.github.io/list">luowei</a>.</span> <span class="site-footer-credits">Developed by <a href="https://luowei.github.io/list">luowei</a>.</span> </footer> </section> </body> </html>
